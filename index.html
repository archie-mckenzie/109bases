<!DOCTYPE html>
<head>
    <title>109 Bases</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel = "stylesheet" type = "text/css" href = "stylesheet.css">
    <script type="text/javascript" src="index.js"></script>
</head>
<body>
    <script type="text/javascript" src="ismobile.js"></script>
    <script>
        if (isMobile) {
            window.location.href = "mobile.html";
        }
    </script>
    <div id="proposal" class="question">Get Ready</div>
    <div id="instructions"></div>
    <input type="text" id="response" class="answer" autofocus>
    <div id="timer" class="indicator">‚è∞ 0 üèÜ 0</div>
    <br><br>
    Binary:<input id="binary" type="checkbox" name="binary" checked><br>
    Hexadecimal:<input id="hexadecimal"  type="checkbox" name="hexadecimal" checked><br>
    <br>
    <input id="slider" type="range" min="1" max="8" value="4" oninput="adjustSlider(); reset(); return false;">
    <div id="rangeValue"></div>
    <br>
    <input id="timeSlider" type="range" min="4" max="32" value="32" oninput="adjustTimeSlider(); reset(); return false;">
    <div id="timeLimit"></div>
    <script>
        document.getElementById('proposal').innerText = "";
        document.getElementById('response').value = "";
        document.getElementById('binary').checked = true;
        document.getElementById('hexadecimal').checked = true;
        adjustSlider();
        adjustTimeSlider();
    </script>
    <script>
        // Variables
        let t = 0;
        let streak = 0;
        // let binary = document.getElementById('binary').value;
        // let hexadecimal = document.getElementById('hexadecimal').value;
        // let bits = document.getElementById('slider').value;
        // let interval = document.getElementById('timeSlider').value;

        // Reset
        function reset() {
            t = 0;
            streak = 0;
            generateBase();
            updateTimer();
        }

        // Timer
        var timerID = window.setInterval(updateTimer, 1000);
        function updateTimer() {
            if (t >= document.getElementById('timeSlider').value) {
                t = 0;
                streak = 0;
                generateBase()
            }
            document.getElementById('timer').innerText = "‚è∞ " + t + " üèÜ " + streak;
            t++;
        }

        // Response Submission
        document.getElementById("response").onkeyup = function(e) {
            if (e.which == 13) {
                submitResponse();
            }
        }
        function submitResponse() {
            let problem = document.getElementById('proposal').innerText;
            let instructions = document.getElementById('instructions').innerText;
            let solution = solve(problem, instructions);
            let response = document.getElementById('response').value
            console.log(solution)
            if (response.toUpperCase() == solution || response.toUpperCase() == solution.padStart(document.getElementById('slider').value, '0')) {
                document.getElementById('response').value="";
                streak++;
                t = 0; updateTimer();
                generateBase();
            } else {
                document.getElementById('proposal').style.color="red";
                document.getElementById('instructions').style.color="red";
            }
        }

        // Generating the first number
        generateBase();

    </script>
        
</body>
</html>